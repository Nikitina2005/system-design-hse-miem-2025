# Первое домашнее задание

##  Вводные

Были получены на сайте architecturalkatas.com после нажатия кнопки "Do one!".

Sysop Squad

An electronics giant needs a new trouble-ticket system for their customer-facing IT consultants (the Sysop Squad) in their stores nationwide

Requirements: trouble tickets can be entered by either call-center receptionists, store staff or customers online; tickets route to the appropriate consultant based on location, availability and skill; customers enter consultant evaluation after service; consultant tracks work performed in customer record(s) for future reference

Users: thousands of customers, hundreds of consultants, hundreds of store staff

Перевод:

Sysop Squad

Гиганту электроники требуется новая система оповещения о неполадках для ИТ-консультантов, работающих с клиентами, (Sysop Squad) в своих магазинах по всей стране

Требования: заявки на устранение неполадок могут быть поданы администраторами колл-центра, сотрудниками магазина или покупателями онлайн; заявки направляются соответствующему консультанту в зависимости от местоположения, наличия свободных мест и квалификации; клиенты оценивают работу консультанта после обслуживания; консультант отслеживает выполненную работу в записях о клиентах для дальнейшего использования

Пользователи: тысячи покупателей, сотни консультантов, сотни сотрудников магазина

## Сбор и анализ требований

### Отсев

Срыв сроков внедрения системы приведёт к продолжительным задержкам в реагировании на неполадки, снижению уровня обслуживания клиентов. Отсутствие системы увеличит нагрузку на сотрудников компании, а также приведёт к неэффективному распределению ресурсов.

Успех будет измеряться по сокращению времени реагирования на заявки, повышению удовлетворенности клиентов и снижению доли повторных обращений.

В рамках требований были собраны ключевые пользовательские сценарии и определены источники заявок: колл-центр, сотрудники магазинов, онлайн-заявки от клиентов. Имеются общие принципы распределения заявок на основе геолокации, загрузки и квалификации. Предусмотрен процесс обратной связи от клиентов.

Бюджет на проект выделен, есть команда разработчиков, которая будет заниматься созданием системы по устранению неполадок. При разработке предполагается использование существующих внутренних сервисов компании.

Все предлагаемые к реализации функции системы находятся в пределах реальных технологий и бизнес-возможностей компании.

### Scope Refinement

1. 4 типа пользователей: покупатели, сотрудники магазина, администраторы колл-центра, ИТ-консультанты
2. Подача заявки на устранение неполадок различными пользователями (покупателями, сотрудниками магазина, администраторами колл-центра); распределение заявок по ИТ-консультантам (должно быть не случайным, зависит от того, в каком городе находится пользователь, подавший заявку, свободен подходящий ИТ-консультант или нет, а также от соответсвия заявке компетенций консультанта); система, предлагающая пользователям оценить работу системы и консультанта (оценить по шкале от 1 до 5 скорость и качество обслуживания, все ли понравилось); отслеживание консультантами истории выполненных заявок для каждого клиента (для возможности использовать записи при повторном обращении клиента).
3. Необязательно: если устранение неполадок не требует очного присутствия, распределение может не зависеть от местоположения; улучшение качества обслуживания путем анализа оценок работы консультантов пользователями; ведение базы данных всех заявок с возможностью сгруппировать их по тому, когда была подана заявка, имени клиента или консультанта, сколько времени заняло выполнение заявки; добавление обязательного для заполнения поля с типом неполадки при создании заявки, это бы ускорило обработку и распределение заявок по консультантам.

### Функциональные требования

Оформлены в виде User Story

1. Как пользователь системы оповещения о неполадках (сотрудник магазина / администратор колл-центра / покупатель), я хочу иметь возможность создать заявку на устранение неполадок, чтобы моя проблема была рассмотрена ИТ-консультантом, в том числе приложив необходимые фотографии или документы.
2. Как пользователь, создающий заявку, я хочу, чтобы заявка была направлена подходящему ИТ-консультанту так, чтобы были учтены географическая и временная доступности консультанта, а также его квалификация, чтобы как можно быстрее возникшая проблема была устранена.
3. Как пользователь системы, я хочу иметь возможность оценить работу консультанта и системы после решения проблемы, так как заинтересован в улучшении качества обслуживания.
4. Как сотрудник компании, я хочу собирать оценки скорости, качества и общего впечатления (по шкале от 1 до 5) работы ИТ-консультантов, чтобы впоследствии анализировать их производительность.
5. Как ИТ-консультант, я хочу видеть историю выполненных работ по предыдущим заявкам клиента, чтобы анализировать и учитывать предыдущие обращения клиента при новых заявках.

### Нефункциональные требования

1. Производительность: система должна обрабатывать до 10000 пользователей одновременно без снижения времени отклика более чем до 1 секунды для 95% запросов.
2. Масштабируемость: система должна позволять масштабирование в географии (подключение новых магазинов по всей территории страны) и количестве пользователей без остановки работы всей системы.
3. Отказоустойчивость: система должна иметь возможность автоматического переключения на зеркальные серверы в случае сбоя.
4. Безопасность: все данные (заявки, пользовательские данные, оценки) должны передаваться и храниться в зашифрованном виде, должна быть обязательная аутентификация и авторизация для консультантов, сотрудников магазина и остальных пользователей системы, при обработке персональных данных клиентов должна соблюдаться информационная безопасность, в том числе по защите данных от утечек.
5. Мониторинг: система должна предоставлять централизованный мониторинг и логирование событий, чтобы обеспечить быстрое обнаружение и устранение сбоев, анализ причин ошибок и контроль над системой.
6. Регуляторные требования: система должна соответствовать федеральному закону "О персональных данных" от 27.07.2006 N 152-ФЗ по защите персональных данных, включая возможность удаления данных клиента по запросу.
7. Переносимость и совместимость системы: система должна быть совместима с основными браузерами и работать как на ПК, так и на мобильных устройствах.
8. Пользовательский опыт: интерфейсы системы должны быть интуитивно понятными и доступными, с откликом интерфейса не более 1 секунды при взаимодействии, особенно при создании заявки и оценке работы ИТ-консультанта, чтобы обеспечить быструю и удобную подачу заявки.

### Ограничения

1. Бизнес-модель: B2C, так как Sysop Squad ориентирована на частных потребителей.

2. Основные бизнес-метрики: DAU/MAU, Retention, время от подачи заявки до начала её обработки консультантом, среднее время обработки заявки, средняя оценка качества обслуживания.

Масштабирование: увеличение числа пользователей (клиентов и сотрудников), территориальное масштабирование.

3. География пользователей: по всей России.

Нужно учитывать территориальное распределение ИТ-консультантов и пользователей.

4. Специфика домена: e-commerce

Большое количество пользователей, важна скорость отклика и простота интерфейса, важны оценки клиентов, возможны частые подачи заявок клиентом после покупок электроники.

5. Тип устройств: мобильные устройства, персональные компьютеры.

Важна кроссплатформенность системы.

6. Этап развития: MVP

Важен сбор отзывов пользователей в реальном времени для непрерывного улучшения.

7. Тип развертывания: Cloud

Позволяет не обеспечивать серверную инфраструктуру для каждого региона, обеспечивает масштабирование при росте числа пользователей, проще интеграция с другими сервисами (CRM, уведомления).

8. Время разработки: 6 месяцев

Время на разработку ограничено, так как это MVP.

9. Бюджет на технологии:

Бюджет также ограничен, предполагается использование уже существующих сервисов и решений, в том числе open-source. В приоритете обеспечение защиты персональных данных клиентов.

10. Технологии (тех. компас компании): PostgreSQL, Python, Kafka, React, Docker, Kubernetes.

Переиспользование существующих механизмов авторизации и аутентификации, мониторинга, имеющейся базы пользователей.

11. Существующие сервисы: корпоративная CRM, система авторизации, система учёта обращений для сотрудников (helpdesk).

12. Бюджет на железо: ограничен, желательно без масштабной покупки серверов

Приоритет отдается облачным технологиям и автоматическому масштабированию по нагрузке.

13. SLA (доступность, производительность):

Система должна быть доступна в часы работы магазинов и колл-центров, в остальное время могут быть выделены фиксированные часы для проведения технических работ.

Время отклика интерфейса: не более 1 секунды для 95% запросов, не более 5 секунд на тяжелые запросы, например, просмотр истории заявок клиента.

14. Регуляторные ограничения: соблюдение федерального закона "О персональных данных" от 27.07.2006 N 152-ФЗ.

Необходимо наличие возможности удаления персональных данных по запросу пользователя.

15. Интеграции: API для уведомлений по статусу заявки (SMS, email).

16. Санкции и импортозамещение: использование отечественных платформ, например, VK Cloud или Yandex Cloud.

### Расчет нагрузки
#### Трафик

Оценка числа пользователей системы:

Покупатели: 5 миллионов пользователей системы в год, 400 тысяч активных в месяц, до 20 тысяч в день

Сотрудники магазинов: около 5000

Администраторы колл-центров: около 2000

ИТ-консультанты: около 2000

Средняя активность: 30000 заявок в систему в день, максимум достигает 50000 в день

Максимальная нагрузка: 50000 заявок в день, следовательно, приблизительно 1 заявка в 2 секунды

Рассчитаем RPS (request per second), возможные операции в системе: создание заявки, распределение заявки ИТ-консультанту, оценка работы клиентом, просмотр истории заявок клиента, обновление статуса заявки.

Следовательно, можно оценить верхнюю границу трафика как 5 RPS в самом загруженном состоянии системы.

#### БД

Пусть на одну заявку приходится максимум 1 MB памяти в БД с учетом возможных прикрепленных документов к заявке (например, фотографий неполадок).

Если заявок в день максимум 50000, значит, заявки за один день максимум занимают около 50 GB, за один месяц - 1.5 миллионов, это 1.5 TB, а за один год - 18 миллионов и 18 TB.

Историю заявок за прошлые года можно хранить в сжатом виде, так как к ней нет необходимости получать быстрый доступ, и в то же время важно уменьшить занимаемую данными память.
